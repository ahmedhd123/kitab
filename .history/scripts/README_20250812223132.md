# 📚 أدوات سحب الكتب من هنداوي

مجموعة من الأدوات لسحب الكتب من موقع مؤسسة هنداوي وإضافتها تلقائياً إلى نظام كتابي.

## 🛠️ المتطلبات

- Node.js (الإصدار 14 أو أحدث)
- npm أو yarn
- اتصال بالإنترنت

## 📦 التثبيت

```bash
# الانتقال إلى مجلد السكريبتات
cd F:\kitab\scripts

# تثبيت المتطلبات
npm install
```

## 🚀 الاستخدام

### 1. اختبار بسيط لسحب كتاب واحد

```bash
npm run test-scraper
```

### 2. سحب قائمة الكتب من هنداوي

```bash
node simple-hindawi-scraper.js
```

### 3. الاستيراد الكامل إلى نظام كتابي

```bash
node run-hindawi-import.js
```

أو:

```bash
npm run hindawi
```

## 📁 الملفات

- `hindawi-scraper.js` - سكريبت متقدم باستخدام Puppeteer
- `simple-hindawi-scraper.js` - سكريبت مبسط باستخدام Axios و Cheerio
- `kitab-api-client.js` - عميل API للتواصل مع نظام كتابي
- `run-hindawi-import.js` - السكريبت الرئيسي للاستيراد الكامل
- `test-scraper.js` - اختبار بسيط للتأكد من عمل السحب

## ⚙️ التكوين

### تغيير عدد الكتب المسحوبة

في ملف `simple-hindawi-scraper.js`:

```javascript
this.maxBooks = 20; // غير هذا الرقم
```

### تغيير رابط API النظام

في ملف `kitab-api-client.js`:

```javascript
constructor(baseUrl = 'YOUR_API_URL_HERE') {
    this.baseUrl = baseUrl;
    // ...
}
```

### تغيير بيانات تسجيل الدخول

في ملف `kitab-api-client.js`:

```javascript
async login(email = 'admin@kitabi.com', password = 'admin123') {
    // غير البيانات هنا
}
```

## 📊 المخرجات

### الملفات المنتجة:

1. `hindawi_books.json` - بيانات الكتب المسحوبة
2. `hindawi_import_report_[timestamp].json` - تقرير مفصل للاستيراد
3. `import_log.txt` - سجل العمليات
4. `downloads/hindawi/` - مجلد الملفات المحملة (إذا استخدم)

### تنسيق التقرير:

```json
{
  "timestamp": "2025-08-12T19:30:00.000Z",
  "booksFound": 5,
  "successfulUploads": 4,
  "failedUploads": 1,
  "booksBefore": 2,
  "booksAfter": 6,
  "booksAdded": 4,
  "books": [...]
}
```

## 🔧 استكشاف الأخطاء

### خطأ في الاتصال بالموقع

```bash
# تأكد من الاتصال بالإنترنت
ping www.hindawi.org

# جرب تغيير User Agent أو إضافة تأخير أكبر
```

### خطأ في رفع الكتب للنظام

```bash
# تأكد من تشغيل نظام كتابي
# تأكد من صحة بيانات تسجيل الدخول
# تحقق من رابط API
```

### نفاد الذاكرة

```bash
# قلل عدد الكتب المسحوبة في المرة الواحدة
# استخدم Simple Scraper بدلاً من Puppeteer
```

## 🚀 الميزات

- ✅ سحب تلقائي للكتب من هنداوي
- ✅ استخراج البيانات الوصفية (العنوان، المؤلف، الوصف، إلخ)
- ✅ تحميل صور الأغلفة
- ✅ تحميل ملفات PDF و EPUB
- ✅ رفع تلقائي إلى نظام كتابي
- ✅ تقارير مفصلة ووسائل
- ✅ معالجة الأخطاء والاستثناءات
- ✅ دعم للتأخير بين الطلبات
- ✅ تنظيف وتصنيف البيانات

## 📝 ملاحظات

- يحترم السكريبت قيود الموقع ويضع تأخير بين الطلبات
- يتم حفظ جميع البيانات محلياً قبل الرفع
- يمكن إيقاف وإعادة تشغيل العملية في أي وقت
- يدعم معالجة الأخطاء والمحاولات المتعددة

## 🤝 المساهمة

لإضافة ميزات جديدة أو إصلاح أخطاء:

1. إنشاء fork للمشروع
2. إنشاء فرع جديد للميزة
3. إجراء التغييرات وإختبارها
4. إرسال Pull Request

## 📄 الترخيص

MIT License - يمكن استخدام الكود بحرية مع ذكر المصدر.

## 🆘 الدعم

للمساعدة أو الاستفسارات:
- فتح issue في GitHub
- التواصل عبر البريد الإلكتروني
- مراجعة الدوكيومنتيشن

---

**تنبيه**: تأكد من احترام شروط استخدام موقع هنداوي وعدم الإفراط في الطلبات.
